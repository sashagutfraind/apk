#!/usr/bin/python
'''
 Copyright (c) 2011-2014, Alexander Gutfraind
   All rights reserved.
   Details in license.txt
'''

'''
 Generator for very simplified synthetic populations for Chicago-area PWID
'''

import csv, time, os, sys, pdb, random
import numpy as np
import numpy.random as npr

MONTHS = ['Jan', 'Feb', 'Mar', 'April', 'May', 'June', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
ALLZIPS = [14537,14626,21044,23220,27716,29482,31410,33570,34601,37421,38344,41031,46250,46250,46304,46311,46312,46312,46320,46323,46323,46324,46342,46349,46350,46360,46360,46368,46373,46373,46383,46383,46383,46408,46410,46617,46637,46637,47974,48146,50441,53121,53128,53128,53128,53140,53140,53147,53149,53157,53168,53207,53207,53235,53410,53589,53719,54143,54880,55331,55412,59606,60002,60002,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60004,60005,60005,60005,60005,60005,60005,60005,60005,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60007,60008,60008,60008,60008,60008,60008,60008,60008,60008,60008,60008,60010,60010,60010,60010,60012,60013,60013,60013,60013,60013,60013,60013,60013,60013,60013,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60014,60015,60015,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60016,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60018,60019,60020,60020,60020,60020,60020,60020,60021,60021,60021,60021,60021,60021,60024,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60025,60026,60030,60030,60030,60030,60030,60031,60031,60033,60033,60033,60033,60034,60034,60035,60036,60040,60040,60041,60041,60041,60041,60041,60042,60042,60044,60046,60046,60046,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60047,60048,60048,60048,60048,60048,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60050,60051,60051,60051,60051,60051,60051,60051,60051,60053,60053,60053,60053,60053,60053,60053,60053,60053,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60056,60057,60057,60057,60060,60060,60060,60060,60060,60060,60060,60060,60060,60060,60061,60061,60061,60061,60061,60061,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60062,60064,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60067,60068,60068,60068,60068,60068,60068,60068,60069,60069,60069,60069,60070,60070,60072,60073,60073,60073,60073,60073,60073,60073,60073,60073,60073,60073,60073,60073,60073,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60074,60076,60076,60076,60076,60077,60077,60077,60077,60077,60077,60077,60077,60077,60077,60077,60077,60081,60084,60084,60084,60084,60084,60084,60084,60084,60084,60084,60084,60084,60085,60085,60085,60085,60085,60085,60085,60085,60086,60087,60087,60087,60087,60087,60087,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60089,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60090,60091,60093,60093,60093,60093,60093,60093,60093,60093,60093,60093,60093,60093,60097,60097,60097,60097,60097,60097,60097,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60098,60099,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60101,60102,60102,60102,60102,60102,60102,60102,60102,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60103,60104,60104,60104,60104,60104,60104,60104,60104,60104,60104,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60106,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60107,60108,60108,60108,60108,60108,60108,60108,60108,60108,60108,60108,60110,60110,60110,60110,60110,60110,60110,60110,60115,60115,60115,60115,60115,60115,60117,60118,60118,60118,60118,60119,60119,60119,60120,60120,60120,60120,60120,60120,60120,60123,60123,60123,60123,60123,60123,60123,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60126,60130,60130,60130,60130,60130,60130,60130,60130,60130,60130,60130,60130,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60131,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60133,60134,60134,60134,60134,60134,60135,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60137,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60139,60140,60140,60141,60142,60142,60142,60142,60142,60143,60143,60143,60143,60143,60143,60146,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60148,60151,60152,60152,60152,60152,60152,60152,60152,60152,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60153,60154,60154,60154,60154,60154,60154,60154,60154,60154,60155,60155,60156,60156,60156,60156,60156,60156,60156,60156,60156,60156,60156,60156,60156,60157,60157,60158,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60160,60162,60162,60162,60162,60163,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60164,60165,60165,60165,60165,60165,60167,60169,60169,60169,60169,60169,60169,60169,60169,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60171,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60172,60173,60173,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60174,60175,60176,60176,60176,60176,60176,60176,60176,60176,60177,60177,60177,60177,60177,60178,60178,60178,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60181,60184,60184,60185,60185,60185,60185,60185,60185,60185,60185,60185,60185,60185,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60187,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60188,60189,60190,60190,60190,60190,60191,60191,60191,60191,60191,60191,60191,60191,60191,60191,60191,60192,60192,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60193,60194,60194,60194,60194,60194,60194,60194,60194,60194,60195,60195,60195,60195,60195,60195,60195,60201,60201,60201,60202,60202,60202,60202,60202,60203,60203,60219,60219,60301,60301,60301,60301,60301,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60302,60304,60304,60304,60304,60304,60304,60304,60305,60305,60305,60305,60305,60353,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60402,60403,60405,60405,60406,60406,60406,60406,60407,60408,60408,60408,60408,60408,60408,60409,60409,60409,60409,60410,60410,60410,60411,60411,60411,60411,60411,60411,60412,60415,60415,60415,60415,60415,60415,60415,60415,60415,60415,60415,60415,60415,60416,60416,60418,60419,60419,60419,60419,60420,60420,60420,60421,60421,60422,60422,60423,60423,60424,60425,60428,60430,60431,60431,60431,60431,60431,60432,60432,60432,60433,60433,60433,60433,60433,60434,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60435,60436,60436,60436,60436,60436,60436,60436,60436,60436,60437,60438,60438,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60439,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60440,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60441,60442,60443,60443,60443,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60445,60446,60446,60446,60446,60446,60446,60446,60446,60446,60446,60446,60446,60447,60447,60447,60448,60448,60448,60448,60450,60450,60450,60450,60450,60450,60450,60450,60452,60452,60452,60452,60452,60452,60452,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60453,60454,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60455,60456,60456,60456,60456,60457,60457,60457,60457,60457,60457,60457,60457,60457,60457,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60458,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60459,60462,60462,60462,60462,60462,60462,60462,60462,60462,60462,60462,60462,60462,60463,60463,60463,60463,60463,60464,60464,60464,60464,60465,60465,60465,60465,60465,60465,60465,60465,60465,60465,60465,60465,60465,60465,60466,60467,60467,60467,60468,60468,60469,60471,60471,60472,60475,60477,60477,60477,60477,60477,60477,60477,60477,60477,60477,60477,60477,60478,60480,60481,60481,60481,60481,60481,60481,60481,60481,60481,60481,60481,60481,60482,60482,60482,60482,60482,60482,60487,60487,60487,60490,60490,60491,60491,60501,60501,60501,60501,60501,60501,60501,60501,60501,60501,60502,60502,60503,60503,60504,60504,60504,60504,60504,60504,60504,60504,60504,60504,60504,60504,60504,60504,60505,60505,60505,60505,60505,60505,60505,60505,60505,60505,60505,60505,60505,60505,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60506,60510,60510,60510,60510,60510,60510,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60513,60514,60514,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60515,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60516,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60517,60519,60520,60520,60520,60521,60521,60521,60521,60521,60521,60521,60521,60521,60521,60521,60523,60523,60523,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60525,60526,60526,60526,60526,60526,60526,60526,60526,60527,60527,60527,60527,60527,60527,60527,60527,60527,60527,60527,60527,60532,60532,60532,60532,60532,60532,60532,60532,60532,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60534,60535,60538,60538,60538,60540,60540,60540,60540,60540,60540,60540,60540,60540,60540,60540,60540,60543,60543,60543,60544,60544,60544,60545,60545,60546,60546,60546,60546,60546,60546,60546,60546,60546,60546,60546,60546,60546,60546,60548,60548,60548,60554,60554,60554,60554,60555,60555,60555,60555,60555,60559,60559,60559,60559,60559,60559,60559,60559,60559,60559,60561,60561,60561,60561,60561,60561,60561,60561,60561,60561,60563,60563,60563,60563,60563,60563,60563,60564,60565,60565,60565,60586,60586,60586,60586,60601,60601,60601,60602,60602,60602,60603,60604,60604,60604,60604,60604,60604,60604,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60605,60606,60606,60606,60606,60606,60606,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60607,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60608,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60609,60610,60610,60610,60610,60610,60610,60610,60610,60610,60610,60610,60610,60610,60611,60611,60611,60611,60611,60611,60611,60611,60611,60611,60611,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60612,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60613,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60614,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60615,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60616,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60617,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60618,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60619,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60620,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60621,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60622,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60623,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60624,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60625,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60626,60627,60627,60627,60627,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60628,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60629,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60630,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60631,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60632,60633,60633,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60634,60635,60635,60635,60635,60635,60635,60635,60635,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60636,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60637,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60638,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60639,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60640,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60641,60642,60642,60642,60642,60642,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60643,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60644,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60645,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60646,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60647,60648,60648,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60649,60650,60650,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60651,60652,60652,60652,60652,60652,60652,60652,60652,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60653,60654,60654,60654,60655,60655,60655,60655,60655,60655,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60656,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60657,60658,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60659,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60660,60661,60661,60661,60661,60661,60661,60662,60670,60674,60686,60688,60691,60691,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60706,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60707,60708,60712,60712,60712,60714,60714,60714,60714,60714,60714,60714,60714,60714,60714,60802,60803,60803,60803,60803,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60804,60805,60805,60805,60805,60805,60805,60805,60805,60824,60827,60827,60827,60827,60827,60827,60827,60827,60827,60837,60844,60844,60863,60864,60901,60915,60915,60935,60935,60964,61008,61008,61038,61068,61073,61101,61101,61103,61107,61108,61108,61108,61109,61115,61135,61270,61301,61301,61301,61329,61354,61356,61356,61701,61701,61701,61701,61759,61764,61764,61913,62040,62040,62234,62234,62237,62243,62703,62890,62959,70214,90021,94114,94176,94607,94707,94941,97225,]

makeAgeNEP         = lambda ego, inparams: npr.randint(20, 60)
makeAgeStartedNEP  = lambda ego, inparams: max(18, ego['AGE'] - npr.randint(0, 20))
makeAgeStartedNHBS = lambda ego, inparams: npr.randint(18,35)
makeBirthDateNHBS  = lambda ego, inparams: '%d-%s-%d'%(npr.randint(1,29),MONTHS[npr.randint(12)], npr.randint(1960,1995)-1900)

def makeGenderNEP(ego, inparams):
    roll = npr.rand()
    if roll < inparams.get('male', 0.7):
        return '1'
    else:
        return '0' #Female
    
def makeGenderNHBS(ego, inparams):
    roll = npr.rand()
    if roll < inparams.get('male', 0.7):
        return '1'
    else:
        return '2'  #Female
    
def makeHCV_NHBS(ego, inparams):
    roll = npr.rand()
    roll -= inparams.get('NHBSHCVpos', 0.3)
    if roll < 0:
        return '1'
    else:
        return '0'

def makeHIV_NHBS(ego, inparams):
    roll = npr.rand()
    roll -= inparams.get('NHBSHIVpos', 0.05)
    if roll < 0:
        return '1'
    else:
        return '0'
    
makeInDegNEP     = lambda ego, inparams: npr.poisson(0.4)
makeOutDegNEP    = lambda ego, inparams: npr.poisson(0.4)
makeInjPer30NEP  = lambda ego, inparams: npr.randint(1,30)
makeInjPerDayNEP = lambda ego, inparams: npr.randint(1,10)
makeNonSterileEpisodesNEP = lambda ego, inparams: int(npr.rand()*ego['Q8A']*ego['Q8B'])
makeQuestdateNEP = lambda ego, inparams: '12/01/2005'
makeQuestdateNHBS= lambda ego, inparams: '10-Oct-09'

makeInjIntNHBS   = lambda ego, inparams: npr.randint(1, 9)
makeSharingNHBS  = lambda ego, inparams: npr.randint(0, 5)

def makeRaceNEP(ego, inparams):
    roll = npr.rand()
    roll -= inparams.get('Black', 0.3)
    if roll < 0:
        return '1'
    roll -= inparams.get('NHWhite', 0.4)
    if roll < 0:
        return '2'
    else:
        return '3'

def makeRaceNHBS(ego, inparams):
    roll = npr.rand()
    roll -= inparams.get('Black', 0.4)
    if roll < 0:
        return {'racee':0, 'racec':1, 'ES3':'0'}
    roll -= inparams.get('NHWhite', 0.2)
    if roll < 0:
        return {'racee':1, 'racec':0, 'ES3':'0'}
    else:
        return {'racee':0, 'racec':0, 'ES3':'1'}

    
#makeZIP = lambda ego, inparams: 60600 + npr.randint(0,200)  #too many errors
makeZIP = lambda ego, inparams: random.sample(ALLZIPS, 1)[0]

NEP = [
    {'field':'AGE',       'maker':(lambda ego, inparams:makeAgeNEP(ego, inparams))},
    {'field':'Q3',        'maker':(lambda ego, inparams:makeAgeStartedNEP(ego, inparams))},
    {'field':'Q12B',      'maker':(lambda ego, inparams:makeInDegNEP(ego, inparams))},
    {'field':'Q16A',      'maker':(lambda ego, inparams:makeOutDegNEP(ego, inparams))},
    {'field':'Q8A',       'maker':(lambda ego, inparams:makeInjPer30NEP(ego, inparams))},
    {'field':'Q8B',       'maker':(lambda ego, inparams:makeInjPerDayNEP(ego, inparams))},
    {'field':'Q9A',       'maker':(lambda ego, inparams:makeNonSterileEpisodesNEP(ego, inparams))},
    {'field':'QUESTDATE', 'maker':(lambda ego, inparams:makeQuestdateNEP(ego, inparams))},
    {'field':'RACEETH',   'maker':(lambda ego, inparams:makeRaceNEP(ego, inparams))},
    {'field':'SEX',       'maker':(lambda ego, inparams:makeGenderNEP(ego, inparams))},
    {'field':'ZIPCODE',   'maker':(lambda ego, inparams:makeZIP(ego, inparams))},
]

NHBS = [
    {'field':'QUESTDATE',       'maker':(lambda ego, inparams:makeQuestdateNHBS(ego, inparams))},
    {'field':'ES1',             'maker':(lambda ego, inparams:makeBirthDateNHBS(ego, inparams))},
    {'field':'HCVEIARSLT1',     'maker':(lambda ego, inparams:makeHCV_NHBS(ego, inparams))},
    {'field':'HIVRSLT',         'maker':(lambda ego, inparams:makeHIV_NHBS(ego, inparams))},
    {'field':'q99aidu',         'maker':(lambda ego, inparams:makeAgeStartedNHBS(ego, inparams))},
    {'field':'q103num_na',      'maker':(lambda ego, inparams:makeInDegNEP(ego, inparams))},
    {'field':'q102inj12b',      'maker':(lambda ego, inparams:makeInjIntNHBS(ego, inparams))},
    {'field':'q106sharndle',    'maker':(lambda ego, inparams:makeSharingNHBS(ego, inparams))},
    {'field':'racec',           'maker':(lambda ego, inparams:None)}, #placeholder.  we use the _RACE method
    {'field':'racee',           'maker':(lambda ego, inparams:None)}, #use _RACE
    {'field':'ES3',             'maker':(lambda ego, inparams:None)}, #use _RACE
    {'field':'_RACE',           'maker':(lambda ego, inparams:makeRaceNHBS(ego, inparams))},
    {'field':'ES9',             'maker':(lambda ego, inparams:makeGenderNHBS(ego, inparams))},
    {'field':'Q2',              'maker':(lambda ego, inparams:makeZIP(ego, inparams))},
]

def generate_dataset(datafields, params):
    fieldnames = [d['field'] for d in datafields]
    with open(params['ofilepath'], 'w') as ofile:
        writer = csv.DictWriter(ofile, fieldnames)
        writer.writeheader()
        for rownum in xrange(params.get('count', 100)):
            outdict = {}
            for fieldinfo in datafields:
                res = fieldinfo['maker'](outdict, params)
                if type(res) is not dict:
                    outdict[fieldinfo['field']] = res
                else:
                    outdict.update(res)
            writer.writerow(outdict)
        print('Written: ' + ofile.name)

generate_dataset(datafields=NEP,  params={'count':5000, 'ofilepath':'../NEP_mock_2014-03-31.csv'})
generate_dataset(datafields=NHBS, params={'count':500,  'ofilepath':'../NHBS_mock_2014-03-31.csv'})

